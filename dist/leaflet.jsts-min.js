!function(){var t=new jsts.geom.GeometryFactory,n={from:function(t,n){var e,s;if(t instanceof jsts.geom.MultiPolygon)e=this.multiPolygonToLatLngs(t),s=L.MultiPolygon;else if(t instanceof jsts.geom.MultiLineString)e=this.multiLineStringToLatLngs(t),s=L.MultiPolyline;else if(t instanceof jsts.geom.Polygon)e=this.polygonToLatLngs(t),s=L.Polygon;else{if(!(t instanceof jsts.geom.LineString))throw new Error("Unsupported geometry");e=this.lineStringToLatLngs(t),s=L.Polyline}return new s(e,n)},coordinateToLatLng:function(t){return new L.LatLng(t.y,t.x)},coordinatesToLatLngs:function(t){return t.map(this.coordinateToLatLng,this)},linearRingToLatLngs:function(t){return this.coordinatesToLatLngs(t.getCoordinates().slice(0,-1))},lineStringToLatLngs:function(t){return t.getCoordinates().map(this.coordinateToLatLng,this)},multiLineStringToLatLngs:function(t){for(var n=[],e=0,s=t.getNumGeometries();s>e;e++)n.push(this.lineStringToLatLngs(t.getGeometryN(e)));return n},multiPolygonToLatLngs:function(t){for(var n=[],e=0,s=t.getNumGeometries();s>e;e++)n.push(this.polygonToLatLngs(t.getGeometryN(e)));return n},polygonToLatLngs:function(t){for(var n=this.linearRingToLatLngs(t.getExteriorRing()),e=[],s=0,o=t.getNumInteriorRing();o>s;s++)e.push(this.linearRingToLatLngs(t.getInteriorRingN(s)));return e.length?[n].concat(e):n}},e={from:function(n){var e,s;if(n instanceof L.MultiPolygon)return e=n.getLatLngs().map(this.multiLatLngsToCoordinates,this),s=e.map(this.coordinatesToPolygon,this),t.createMultiPolygon(s);if(n instanceof L.MultiPolyline)return e=latlngs.getLatLngs().map(this.multiLatLngsToCoordinates,this),s=e.map(this.coordinatesToLineString,this),t.createMultiLineString(s);if(n instanceof L.Polygon)return e=this.multiLatLngsToCoordinates(n.getLatLngs()),this.coordinatesToPolygon(e);if(n instanceof L.Polyline)return e=this.latLngsToCoordinates(n.getLatLngs()),this.coordinatesToLineString(e);throw new Error("Unsupported layer")},coordinatesToLinearRing:function(n){return t.createLinearRing(n.concat(n[0]))},coordinatesToLineString:function(n){return t.createLineString(n)},coordinatesToPolygon:function(n){var e=n.map(this.coordinatesToLinearRing,this);return e.length<2?t.createPolygon(e[0],[]):t.createPolygon(e[0],e.slice(1))},latLngToCoordinate:function(t){return new jsts.geom.Coordinate(t.lng,t.lat)},latLngsToCoordinates:function(t){return t.map(this.latLngToCoordinate,this)},multiLatLngsToCoordinates:function(t){return t.length?Array.isArray(t[0])?t.map(this.latLngsToCoordinates,this):[t.map(this.latLngToCoordinate,this)]:[]}};L.jsts||(L.jsts={});var s=t.createPolygon(t.createLinearRing([]),[]),o=t.createMultiPolygon([s]),i=t.createLineString([]),r=t.createMultiLineString([i]);L.extend(L.jsts,{FACTORY:t,EMPTY_POLYGON:s,EMPTY_MULTIPOLYGON:o,EMPTY_LINESTRING:i,EMPTY_MULTILINESTRING:r,leafletTojsts:function(t){return e.from(t)},jstsToleaflet:function(t,e){return n.from(t,e)},jstsToLatLngs:function(t){if(t instanceof jsts.geom.MultiPolygon)return n.multiPolygonToLatLngs(t);if(t instanceof jsts.geom.MultiLineString)return n.multiLineStringToLatLngs(t);if(t instanceof jsts.geom.Polygon)return n.polygonToLatLngs(t);if(t instanceof jsts.geom.LineString)return n.lineStringToLatLngs(t);throw new Error("Unsupported geometry")}})}(),function(){function t(t,e){L.Jsts.prototype[t]=function(){return n.apply(this,[e].concat(o.call(arguments,0)))}}function n(t,n){var e=this.geometry();if(e.isEmpty())return!1;var s=n.jsts.geometry();if(s.isEmpty())return!1;if(arguments.length<3)return e[t](s);var i=[s].concat(o.call(arguments,2));return e[t].apply(e,i)}function e(t,n){L.Jsts.prototype[t]=function(){return s.apply(this,[n].concat(o.call(arguments,0)))}}function s(t,n){var e,s=this.geometry(),i=n.jsts.geometry();if(arguments.length<3)e=s[t](i);else{var r=[i].concat(o.call(arguments,2));e=s[t].apply(s,r)}return this._apply(e)}L.Jsts=L.Class.extend({includes:[L.jsts.BinaryTest,L.jsts.BinaryTopology],initialize:function(t){this._target=t},clean:function(){this._target.jstsClean&&this._target.jstsClean()},geometry:function(){return this._target.getJstsGeometry()},_apply:function(t){return this._target.jstsCopy(t)}});var o=Array.prototype.slice,i={intersects:"intersects",within:"within"};for(var r in i)t(r,i[r]);var a={intersection:"intersection",union:"union",difference:"difference"};for(var r in a)e(r,a[r])}(),L.FeatureGroup.include({getJstsGeometry:function(){if(!this._jstsGeometry){var t=L.jsts.EMPTY_MULTIPOLYGON;this.eachLayer(function(n){var e=n.getJstsGeometry();t=t?t.union(e):e}),this._jstsGeometry=t}return this._jstsGeometry},jstsCopy:function(t){if(t.isEmpty())return new this.constructor([]);throw new Error("Unsupported operation!")},jstsClean:function(){delete this._jstsGeometry},jstsOnLayerAdd:function(t){t.layer.editing&&t.layer.on("edit",this.jstsClean,this)},jstsOnLayerRemove:function(t){t.layer.editing&&t.layer.off("edit",this.jstsClean,this)}}),L.FeatureGroup.addInitHook(function(){this.on("layeradd",this.jstsOnLayerAdd,this),this.on("layeradd",this.jstsClean,this),this.on("layerremove",this.jstsClean,this),this.on("layerremove",this.jstsOnLayerRemove,this)}),Object.defineProperty(L.FeatureGroup.prototype,"jsts",{get:function(){return this._jsts||(this._jsts=new L.Jsts(this)),this._jsts}}),function(){var t=L.Path.prototype.redraw;L.Path.include({getJstsGeometry:function(){return this._jstsGeometry||(this._jstsGeometry=L.jsts.leafletTojsts(this)),this._jstsGeometry},jstsCopy:function(t){var n;if(t.isEmpty())if(n=new this.constructor([],this.options),this instanceof L.MultiPolygon)t=L.jsts.EMPTY_MULTIPOLYGON;else if(this instanceof L.MultiPolyline)t=L.jsts.EMPTY_MULTILINESTRING;else if(this instanceof L.Polygon)t=L.jsts.EMPTY_POLYGON;else{if(!(this instanceof L.Polyline))throw new Error("Unsupported L.Path type");t=L.jsts.EMPTY_LINESTRING}else n=L.jsts.jstsToleaflet(t,this.options);return n._jstsGeometry=t,n},redraw:function(){return delete this._jstsGeometry,t.apply(this,arguments)}}),Object.defineProperty(L.Path.prototype,"jsts",{get:function(){return this._jsts||(this._jsts=new L.Jsts(this)),this._jsts}})}();